node {

    // download the
    docker.withRegistry('https://249767383774.dkr.ecr.ap-southeast-1.amazonaws.com', 'ecr:ap-southeast-1:jenkins-ecr') {
        docker.image('proximax-catapult-rest-build-image').pull()
    }

    docker.image('249767383774.dkr.ecr.ap-southeast-1.amazonaws.com/proximax-catapult-rest-build-image').inside {
        stage('Build') {
            echo 'Building proximax-catapult-rest'

            // Display Alpine OS details
            sh 'cat /etc/*release'
        }

        stage('Test') {
            echo 'Running unit tests'

            // TODO: Run the tests while inside the proximax-catapult-rest-build-image Docker container
        }
    }

    stage('Build Docker Image') {
        echo 'Building proximax-catapult-rest Docker image'
    }

    stage('Push Image to Docker Registry') {
        // 249767383774.dkr.ecr.ap-southeast-1.amazonaws.com/proximax-catapult-rest
        echo 'Pushing proximax-catapult-rest Docker image to AWS ECR Docker registry'
    }
}